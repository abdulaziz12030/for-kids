<!doctype html><html lang="ar" dir="rtl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>اختيار المنتج</title>
<link rel="stylesheet" href="css.css">
</head><body>
<header>
  <div class="container nav">
    <div class="brand"><img class="logo" src="images/logo.png"><strong>waai-kids.sa</strong></div>
    <nav class="menu">
      <a href="index.html">الرئيسية</a>
      <a href="product.html" class="is-active">اطلب الآن</a>
      <a href="checkout.html">السلة</a>
    </nav>
  </div>
</header>

<main class="container" style="padding:18px 0">
  <div class="card" data-reveal><div class="body" style="display:grid;gap:12px">
    <h1 id="p-name">—</h1>
    <img id="p-img" alt="" style="border-radius:12px">
    <div class="price">السعر: <strong id="p-price">149</strong> ر.س</div>

    <label>نوع البُكس</label>
    <select id="p-type" class="ghost">
      <option value="baby-girl">بنات</option>
      <option value="baby-boy">أولاد</option>
    </select>

    <label>الكمية</label>
    <div><input id="qty" type="number" min="1" value="1" class="ghost" style="width:110px"></div>

    <!-- بطاقة الإهداء داخل نفس الصفحة -->
    <div class="pill">بطاقة الإهداء (اختياري)</div>
    <label style="display:flex;align-items:center;gap:8px">
      <input type="checkbox" id="enableGift" checked> تفعيل بطاقة الإهداء
    </label>
    <input id="g-name" class="ghost" placeholder="الاسم على البطاقة (مثال: للمولودة شهد)">
    <textarea id="g-msg" class="ghost" rows="3" placeholder="رسالة قصيرة (مثال: نورتِ الدنيا يا أجمل العطايا)"></textarea>
    <input id="g-from" class="ghost" placeholder="من (مثال: من خالتكم مدى)">

    <div class="actions">
      <a class="btn" id="add-cart">إضافة للسلة والمتابعة</a>
      <a class="ghost" href="index.html">رجوع</a>
    </div>
  </div></div>
</main>

<script type="module">
  import { Cart, initReveal } from './js/cart.js';
  initReveal();

  const PRODUCTS = {
    'baby-girl': { name:'بُكس المواليد — بنات', price:149, img:'images/girl.png' },
    'baby-boy' : { name:'بُكس المواليد — أولاد', price:149, img:'images/boy1.png' }
  };

  let sku = new URLSearchParams(location.search).get('sku') || 'baby-girl';
  const img = document.getElementById('p-img');
  const nameEl = document.getElementById('p-name');
  const priceEl = document.getElementById('p-price');
  const typeSel = document.getElementById('p-type');

  function render(){
    const p = PRODUCTS[sku];
    img.src = p.img; nameEl.textContent = p.name; priceEl.textContent = p.price; typeSel.value = sku;
  }
  render();
  typeSel.onchange = () => { sku = typeSel.value; render(); };

  document.getElementById('add-cart').onclick = () => {
    const qty = Math.max(1, parseInt(document.getElementById('qty').value||'1', 10));
    const p = PRODUCTS[sku];
    const enabled = document.getElementById('enableGift').checked;
    const gift = enabled ? {
      name:  document.getElementById('g-name').value.trim(),
      msg:   document.getElementById('g-msg').value.trim(),
      from:  document.getElementById('g-from').value.trim()
    } : null;

    Cart.upsert({ sku, name:p.name, price:p.price, qty, gift });
    location.href = 'checkout.html';
  };
</script>
</body></html>