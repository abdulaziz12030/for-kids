<!doctype html><html lang="ar" dir="rtl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>إتمام الطلب</title><link rel="stylesheet" href="css.css"></head><body>
<header><div class="container nav"><div class="brand"><img class="logo" src="images/logo.png"><strong>واعي كيدز</strong></div><a href="#" class="ghost">🛍️ <span data-cart-count>0</span></a></div></header>
<main class="container" style="padding:18px 0">
  <div class="card"><div class="body">
    <h2>السلة</h2>
    <div id="list"></div>
    <div id="gift"></div>
    <div style="margin-top:8px">الإجمالي: <strong id="total">0</strong> ر.س</div>
    <input class="ghost" id="c-name" placeholder="اسم العميل">
    <input class="ghost" id="c-phone" placeholder="الجوال">
    <input class="ghost" id="c-city" placeholder="المدينة">
    <div class="actions"><a class="btn" id="wa">إرسال عبر واتساب</a><a class="ghost" href="product.html">متابعة التسوق</a></div>
  </div></div>
</main>
<script type="module">
import { Cart } from './js/cart.js';
function fmt(n){return new Intl.NumberFormat('ar-SA').format(n)}
const items=Cart.get(); let total=0; const list=document.getElementById('list');
items.forEach((x,i)=>{ const sum=x.price*x.qty; total+=sum; const d=document.createElement('div'); d.className='pill'; d.style.margin='6px 0'; d.textContent=`${x.name} × ${x.qty} = ${sum} ر.س`; list.appendChild(d); });
document.getElementById('total').textContent=fmt(total);
const last=Cart.getLast(); if(last&&last.gift){const g=last.gift; document.getElementById('gift').innerHTML=`<div class="pill">بطاقة الإهداء</div><div>الاسم: ${g.name||'-'}</div><div>الرسالة: ${g.message||'-'}</div><div>من: ${g.from||'-'}</div>`;}
document.getElementById('wa').onclick=()=>{ const n=(document.getElementById('c-name').value||'').trim(); const p=(document.getElementById('c-phone').value||'').trim(); const c=(document.getElementById('c-city').value||'').trim(); let msg='طلب جديد - واعي كيدز\n'; Cart.get().forEach(x=> msg+=`- ${x.name} × ${x.qty} = ${x.price*x.qty} ر.س\n`); if(last&&last.gift){const g=last.gift; msg+=`\nبطاقة الإهداء:\nالاسم: ${g.name||'-'}\nالرسالة: ${g.message||'-'}\nمن: ${g.from||'-'}\n`; } msg+=`\nالإجمالي: ${total} ر.س\nالعميل: ${n} | ${p} | ${c}`; location.href='https://wa.me/966552794082?text='+encodeURIComponent(msg); };
</script>
</body></html>