<!doctype html><html lang="ar" dir="rtl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ุฅุชูุงู ุงูุทูุจ</title>
<link rel="stylesheet" href="css.css">
</head><body>
<header>
  <div class="container nav">
    <div class="brand">
      <img class="logo" src="images/logo.png" alt="ุดุนุงุฑ ูุงุนู ููุฏุฒ">
      <span style="font-weight:900">ูุงุนู ููุฏุฒ</span>
    </div>
    <a href="checkout.html" class="ghost" style="gap:6px">๐๏ธ <span data-cart-count>0</span></a>
  </div>
</header>

<main class="container" style="padding:18px 0">
  <div class="grid" style="grid-template-columns:1.2fr .8fr">
    <div class="card" data-reveal>
      <div class="body">
        <h2 style="margin:0 0 10px">ุงูุณูุฉ</h2>
        <table style="width:100%;border-collapse:collapse">
          <thead><tr><th style="text-align:right;padding:8px;border-bottom:1px solid #eee">ุงูููุชุฌ</th>
          <th style="text-align:right;padding:8px;border-bottom:1px solid #eee">ุงููููุฉ</th>
          <th style="text-align:right;padding:8px;border-bottom:1px solid #eee">ุงูุณุนุฑ</th>
          <th style="text-align:right;padding:8px;border-bottom:1px solid #eee">ุงูุฅุฌูุงูู</th>
          <th style="text-align:right;padding:8px;border-bottom:1px solid #eee"></th></tr></thead>
          <tbody id="rows"></tbody>
        </table>
        <div id="giftbox" style="margin-top:10px"></div>
      </div>
    </div>

    <div class="card" data-reveal>
      <div class="body">
        <h2 style="margin:0 0 10px">ุจูุงูุงุช ุงูุนููู</h2>
        <input class="ghost" id="c-name" placeholder="ุงูุงุณู">
        <input class="ghost" id="c-phone" placeholder="ุงูุฌูุงู">
        <input class="ghost" id="c-city" placeholder="ุงููุฏููุฉ">
        <div style="margin-top:10px">ุงูุฅุฌูุงูู: <strong id="total">0</strong> ุฑ.ุณ</div>
        <div class="actions" style="margin-top:12px;flex-wrap:wrap">
          <a class="btn" id="wa">ุฅุฑุณุงู ุงูุทูุจ ุนุจุฑ ูุงุชุณุงุจ</a>
          <a class="ghost" href="product.html">ูุชุงุจุนุฉ ุงูุชุณูู</a>
        </div>
      </div>
    </div>
  </div>
</main>

<script type="module">
import { Cart, initReveal } from './js/cart.js';
function fmt(n){return new Intl.NumberFormat('ar-SA').format(n)}
const tbody = document.getElementById('rows');
const items = Cart.get();
let total = 0;
items.forEach((x,i)=>{
  const sum = x.price * x.qty; total += sum;
  const tr = document.createElement('tr');
  tr.innerHTML = \`<td style="padding:8px;border-bottom:1px solid #eee">\${x.name}</td>
                   <td style="padding:8px;border-bottom:1px solid #eee"><span class="pill">\${x.qty}</span></td>
                   <td style="padding:8px;border-bottom:1px solid #eee">\${fmt(x.price)}</td>
                   <td style="padding:8px;border-bottom:1px solid #eee">\${fmt(sum)}</td>
                   <td style="padding:8px;border-bottom:1px solid #eee"><button class="ghost" onclick="removeItem(\${i})">ุญุฐู</button></td>\`;
  tbody.appendChild(tr);
});
document.getElementById('total').textContent = fmt(total);
// gift
const last = items[items.length-1]||{};
if(last.gift){
  const g = last.gift;
  document.getElementById('giftbox').innerHTML = \`<div class="pill">ุจุทุงูุฉ ุงูุฅูุฏุงุก</div>
    <div>ุงูุงุณู: \${g.name||'-'}</div><div>ุงูุฑุณุงูุฉ: \${g.message||'-'}</div><div>ูู: \${g.from||'-'}</div>\`;
}
// removal
window.removeItem = function(i){ const arr = Cart.get(); arr.splice(i,1); Cart.set(arr); location.reload(); };
// whatsapp
document.getElementById('wa').addEventListener('click', ()=>{
  const name=(document.getElementById('c-name').value||'').trim();
  const phone=(document.getElementById('c-phone').value||'').trim();
  const city=(document.getElementById('c-city').value||'').trim();
  let msg='ุทูุจ ุฌุฏูุฏ - ูุงุนู ููุฏุฒ\n';
  Cart.get().forEach(x=> msg += \`- \${x.name} ร \${x.qty} = \${x.price*x.qty} ุฑ.ุณ\n\`);
  if(last.gift){ msg += \`\nุจุทุงูุฉ ุงูุฅูุฏุงุก:\nุงูุงุณู: \${last.gift.name||'-'}\nุงูุฑุณุงูุฉ: \${last.gift.message||'-'}\nูู: \${last.gift.from||'-'}\n\`; }
  msg += \`\nุงูุฅุฌูุงูู: \${total} ุฑ.ุณ\nุงูุนููู: \${name} | \${phone} | \${city}\`;
  location.href = Cart.waLink(msg);
});
initReveal();
</script>
</body></html>
